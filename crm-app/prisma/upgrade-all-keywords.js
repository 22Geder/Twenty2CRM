const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

/**
 * ðŸ§  ×ž×™×œ×•×Ÿ ×ª×’×™×•×ª ×ž×§×™×£ - ×¨×—×‘ ×™×•×ª×¨ ×œ×›×œ ×”×ª×—×•×ž×™×
 */

const CATEGORY_KEYWORDS = {
  // ============ ×‘× ×§××•×ª ×•×¤×™× × ×¡×™× ============
  banking: [
    '×‘× ×§××™', '×‘× ×§××™×ª', '×¤×§×™×“ ×‘× ×§', '×¤×§×™×“×ª ×‘× ×§', '×ž× ×”×œ ×¡× ×™×£', '×ž× ×”×œ×ª ×¡× ×™×£',
    '×¡×’×Ÿ ×ž× ×”×œ', '×¡×’× ×™×ª ×ž× ×”×œ', '×™×•×¢×¥ ×¤×™× × ×¡×™', '×™×•×¢×¦×ª ×¤×™× × ×¡×™×ª', '×™×•×¢×¥ ×”×©×§×¢×•×ª',
    '×™×•×¢×¥ ×ž×©×›× ×ª××•×ª', '×™×•×¢×¥ ×¤× ×¡×™×•× ×™', '×ž× ×”×œ ×ª×™×§×™×', '× ×¦×™×’ ×‘× ×§××•×ª', '× ×¦×™×’×ª ×‘× ×§××•×ª',
    '×¢×ž×™×œ ×‘×•×¨×¡×”', '×‘×§×¨ ××©×¨××™', '×× ×œ×™×¡×˜', '××§×˜×•××¨', '×—×©×‘', '×—×©×‘×ª',
    '××©×¨××™', '×”×œ×•×•××•×ª', '×ž×©×›× ×ª×', '×ž×©×›× ×ª××•×ª', '×¤×™×§×“×•× ×•×ª', '×—×™×¡×›×•×Ÿ',
    '×”×©×§×¢×•×ª', '× ×™×™×¨×•×ª ×¢×¨×š', '×‘×•×¨×¡×”', '×ž×¡×—×¨', '×‘×™×˜×•×—', '×¤× ×¡×™×”', '×’×ž×œ',
    '×§×¨× ×•×ª', '×§×¨×Ÿ ×”×©×ª×œ×ž×•×ª', '×¤×™× × ×¡×™×', '×›×œ×›×œ×”', '×—×©×‘×•× ××•×ª',
    '× ×™×”×•×œ ×¡×™×›×•× ×™×', '× ×™×ª×•×— ××©×¨××™', '× ×™×ª×•×— ×¤×™× × ×¡×™', '×¨×’×•×œ×¦×™×” ×‘× ×§××™×ª',
    '×¢×ž×™×“×” ×‘×™×¢×“×™×', '×ž×›×™×¨×•×ª', '×©×™×ž×•×¨ ×œ×§×•×—×•×ª', '×’×™×•×¡ ×œ×§×•×—×•×ª',
    '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×©×™×¨×•×ª ×œ×§×•×—×•×ª ×¤×¨×™×ž×™×•×', '×œ×§×•×—×•×ª ×¢×¡×§×™×™×', '×œ×§×•×—×•×ª ×¤×¨×˜×™×™×',
    'Excel', 'Office', 'CRM', '×ž×¢×¨×›×•×ª ×‘× ×§××™×•×ª',
    '×‘× ×§', '×¡× ×™×£ ×‘× ×§', '×ž×•×¡×“ ×¤×™× × ×¡×™', '×‘× ×§ ×ž×–×¨×—×™', '×‘× ×§ ×”×¤×•×¢×œ×™×', '×‘× ×§ ×œ××•×ž×™',
    '×‘× ×§ ×“×™×¡×§×•× ×˜', '×‘× ×§ ×ž×¨×›× ×ª×™×œ', '×‘× ×§ ×™×”×‘'
  ],

  // ============ ×©×™×¨×•×ª ×œ×§×•×—×•×ª ×•×ž×•×§×“×™× ============
  customerService: [
    '× ×¦×™×’ ×©×™×¨×•×ª', '× ×¦×™×’×ª ×©×™×¨×•×ª', '× ×¦×™×’ ×ž×•×§×“', '× ×¦×™×’×ª ×ž×•×§×“', '×ž×•×§×“×Ÿ', '×ž×•×§×“× ×™×ª',
    '×˜×œ×ž×¨×§×˜×™× ×’', '×˜×œ×ž×¨×§×˜×¨', '×˜×œ×ž×¨×§×˜×¨×™×ª', '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×ª×ž×™×›×” ×˜×›× ×™×ª',
    '× ×¦×™×’ ×˜×œ×¤×•× ×™', '× ×¦×™×’×ª ×˜×œ×¤×•× ×™×ª', '×ž× ×”×œ ×ž×•×§×“', '×¨××© ×¦×•×•×ª', '×¨××© ×ž×©×ž×¨×ª',
    '×ž× ×”×œ ×œ×§×•×—×•×ª', '×ž× ×”×œ×ª ×œ×§×•×—×•×ª', 'Account Manager',
    '×©×™×¨×•×ª×™×•×ª', '×¡×‘×œ× ×•×ª', '×™×›×•×œ×ª ×”×§×©×‘×”', '×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª', '× ×™×”×•×œ ×©×™×—×•×ª',
    '×ž×™×•×ž× ×•×™×•×ª ×ª×§×©×•×¨×ª', '×ª×§×©×•×¨×ª ×‘×™× ××™×©×™×ª', '×¢×‘×¨×™×ª', '×©×¤×ª ××',
    '×× ×’×œ×™×ª', '×¨×•×¡×™×ª', '×¢×¨×‘×™×ª', '××ž×”×¨×™×ª', '×¦×¨×¤×ª×™×ª', '×¡×¤×¨×“×™×ª',
    '×”×§×œ×“×” ×ž×”×™×¨×”', '×¢×‘×•×“×” ×ž×•×œ ×ž×—×©×‘', '×ž×•×œ×˜×™-×˜××¡×§×™× ×’',
    '×¢×‘×•×“×” ×ª×—×ª ×œ×—×¥', '×¢×ž×™×“×” ×‘×™×¢×“×™×', '×©×™×ž×•×¨ ×œ×§×•×—×•×ª', '×ž×›×™×¨×•×ª',
    '×ž×¢×¨×›×ª CRM', '×ž×¢×¨×›×ª ×˜×œ×¤×•× ×™×”', 'Salesforce',
    '×ž×©×ž×¨×•×ª', '×ž×©×ž×¨×ª ×‘×•×§×¨', '×ž×©×ž×¨×ª ×¢×¨×‘', '×ž×©×ž×¨×ª ×œ×™×œ×”', '×’×ž×™×©×•×ª',
    '×ž×•×§×“ ×ž×›×™×¨×•×ª', '×ž×•×§×“ ×ª×ž×™×›×”', '×ž×•×§×“ ×©×™×¨×•×ª', '×§×•×œ ×¡× ×˜×¨', 'Call Center',
    '×¡×œ×•×œ×¨', '×˜×œ×§×•×', '×ª×§×©×•×¨×ª', '××™× ×˜×¨× ×˜', '×‘×–×§', '×¡×œ×§×•×', '×¤×¨×˜× ×¨', '×”×•×˜',
    'YES', '×˜×œ×¡×œ', '×¤×œ××¤×•×Ÿ', '×’×•×œ×Ÿ ×˜×œ×§×•×', '×œ×™×“×™×', '×œ×™×“×™× ×—×ž×™×'
  ],

  // ============ ×œ×•×’×™×¡×˜×™×§×” ×•×ž×—×¡× ×™× ============
  logistics: [
    '×ž×—×¡× ××™', '×ž×—×¡× ××™×ª', '×ž×œ×’×–×Ÿ', '×ž×œ×’×–× ×™×ª', '×ž×¤×¢×™×œ ×ž×œ×’×–×”', '×¢×•×‘×“ ×ž×—×¡×Ÿ',
    '×¢×•×‘×“×ª ×ž×—×¡×Ÿ', '×ž× ×”×œ ×ž×—×¡×Ÿ', '×ž× ×”×œ×ª ×ž×—×¡×Ÿ', '×ž× ×”×œ ×œ×•×’×™×¡×˜×™×§×”', '×œ×•×’×™×¡×˜×™×§××™',
    '×ž×œ×§×˜', '×ž×œ×§×˜×ª', '×œ×™×§×•×˜', '××•×¨×–', '××•×¨×–×ª', '××¨×™×–×”', '×ž×ž×•× ×” ×ž×©×ž×¨×ª',
    '×ž× ×”×œ ×ª×¤×¢×•×œ', '×¨×›×– ×œ×•×’×™×¡×˜×™', '×ž×ª×× ×ž×©×œ×•×—×™×', '×§×‘×œ×ª ×¡×—×•×¨×”',
    '×¢×‘×•×“×” ×¤×™×–×™×ª', '×¢×‘×•×“×” ×‘×¢×ž×™×“×”', '×”×¨×ž×ª ×ž×©××•×ª', '×¡×“×¨ ×•××¨×’×•×Ÿ',
    '×›×•×©×¨ ×’×•×¤× ×™', '×¢×‘×•×“×” ×‘×ž×©×ž×¨×•×ª', '×œ×—×¥', '×“×™×•×§', '××—×¨×™×•×ª', '××ž×™× ×•×ª',
    '× ×™×”×•×œ ×ž×œ××™', '×¡×¤×™×¨×ª ×ž×œ××™', '×‘×§×¨×ª ×ž×œ××™', '×§×‘×œ×” ×•×©×™×œ×•×—',
    'WMS', '×ž×¢×¨×›×ª WMS', 'Priority', 'SAP', 'ERP', '×¡×¨×™×§×ª ×‘×¨×§×•×“', '×ž×¡×•×¤×•×Ÿ',
    '×¨×™×©×™×•×Ÿ ×ž×œ×’×–×”', '×ž×œ×’×–×” ×¤× ×™×ž×™×ª', '×¨×™×©×™×•×Ÿ × ×”×™×’×”', '×¨×™×©×™×•×Ÿ B', '×¨×™×©×™×•×Ÿ C',
    '×ž×—×¡×Ÿ ×œ×•×’×™×¡×˜×™', '×ž×¨×›×– ×œ×•×’×™×¡×˜×™', '×ž×¨×›×– ×”×¤×¦×”', '×”×¤×¦×”', '××¡×¤×§×”',
    '×©×¨×©×¨×ª ××¡×¤×§×”', 'Supply Chain', '×™×™×‘×•×', '×™×™×¦×•×', '×ž×›×¡',
    '× ×”×’', '× ×”×’ ×ž×©××™×ª', '× ×”×’ ×”×¤×¦×”', '×ž×©×œ×•×—×™×', '×—×œ×•×§×”'
  ],

  // ============ ×ž×›×™×¨×•×ª ============
  sales: [
    '××™×© ×ž×›×™×¨×•×ª', '××©×ª ×ž×›×™×¨×•×ª', '× ×¦×™×’ ×ž×›×™×¨×•×ª', '× ×¦×™×’×ª ×ž×›×™×¨×•×ª', '×¡×•×›×Ÿ ×ž×›×™×¨×•×ª',
    '×¡×•×›× ×ª ×ž×›×™×¨×•×ª', '×ž× ×”×œ ×ž×›×™×¨×•×ª', '×ž× ×”×œ×ª ×ž×›×™×¨×•×ª', '×ž× ×”×œ ×œ×§×•×—×•×ª',
    'Account Executive', 'Sales Representative', 'BDM', '×¤×™×ª×•×— ×¢×¡×§×™',
    '×ž× ×”×œ ×¤×™×ª×•×— ×¢×¡×§×™', '××™×© ×©×˜×—', '××©×ª ×©×˜×—', '×¡×•×›×Ÿ ×©×˜×—', '× ×¦×™×’ ×©×˜×—',
    '×ž×›×™×¨×•×ª', '×ž×›×™×¨×•×ª ×¤×¨×•× ×˜×œ×™×•×ª', '×ž×›×™×¨×•×ª ×˜×œ×¤×•× ×™×•×ª', '×ž×›×™×¨×•×ª ×©×˜×—',
    '×ž×›×™×¨×•×ª B2B', '×ž×›×™×¨×•×ª B2C', '×ž×›×™×¨×•×ª ×“×™×’×™×˜×œ×™×•×ª', 'E-commerce',
    '×™×¢×“×™×', '×¢×ž×™×“×” ×‘×™×¢×“×™×', '×¢×ž×œ×•×ª', '×‘×•× ×•×¡×™×', '×ª×’×ž×•×œ ×ž×›×™×¨×•×ª',
    '×ž×©× ×•×ž×ª×Ÿ', '×¡×’×™×¨×ª ×¢×¡×§××•×ª', '×©×›× ×•×¢', '×™×›×•×œ×ª ×ž×›×™×¨×”', '×“×¨×™×™×‘',
    '×’×™×•×¡ ×œ×§×•×—×•×ª', '×©×™×ž×•×¨ ×œ×§×•×—×•×ª', '×”×¨×—×‘×ª ×œ×§×•×—×•×ª', '×ª×™×§ ×œ×§×•×—×•×ª',
    '× ×™×”×•×œ ×œ×§×•×—×•×ª', 'CRM', 'Salesforce', 'HubSpot',
    '×”×¦×’×ª ×ž×•×¦×¨', '×“×ž×•', '×¤×¨×–× ×˜×¦×™×”', '×ž×¦×’×•×ª', '×œ×™×“×™×',
    '×œ×™×“×™× ×—×ž×™×', '×œ×™×“×™× ×§×¨×™×', 'Cold Calling', 'Outbound', 'Inbound'
  ],

  // ============ ×¨×›×‘ ============
  automotive: [
    '××™×© ×ž×›×™×¨×•×ª ×¨×›×‘', '××©×ª ×ž×›×™×¨×•×ª ×¨×›×‘', '×¡×•×›×Ÿ ×ž×›×™×¨×•×ª ×¨×›×‘', '× ×¦×™×’ ×ž×›×™×¨×•×ª ×¨×›×‘',
    '×ž× ×”×œ ××•×œ×', '×ž× ×”×œ×ª ××•×œ×', '×ž× ×”×œ ××•×œ× ×ª×¦×•×’×”', '×ž×›×™×¨×•×ª ×¨×›×‘',
    '××•×œ× ×ª×¦×•×’×”', '×¡×•×›× ×•×ª ×¨×›×‘', '×©×•××•-×¨×•×', 'Showroom',
    '×˜×¨×™×™×“ ××™×Ÿ', 'Trade In', '×”×—×œ×¤×ª ×¨×›×‘', '×ž×™×ž×•×Ÿ ×¨×›×‘', '×œ×™×¡×™× ×’',
    '×œ×™×¡×™× ×’ ×¤×¨×˜×™', '×œ×™×¡×™× ×’ ×¢×¡×§×™', '×”×©×›×¨×ª ×¨×›×‘', '×™×“ ×¨××©×•× ×”', '×™×“ 2',
    '×™×•×¢×¥ ×©×™×¨×•×ª', '×™×•×¢×¦×ª ×©×™×¨×•×ª', '×§×‘×œ×”', '×“×™×™×œ ×§×‘×œ×”', '×“×™×™×œ×ª ×§×‘×œ×”',
    '× ×¡×™×¢×ª ×ž×‘×—×Ÿ', '×”×ª×¨×©×ž×•×ª', '×ž×¡×™×¨×ª ×¨×›×‘',
    '×ž×›×•× ××™ ×¨×›×‘', '×ž×›×•× ××™', '×—×©×ž×œ××™ ×¨×›×‘', '×¤×—×—×•×ª', '×¦×‘×™×¢×”',
    '×ž×›×•×Ÿ ×¨×™×©×•×™', '×˜×¡×˜', '×‘×“×™×§×ª ×¨×›×‘',
    'UNION', 'GAC', 'GEELY', '×˜×•×™×•×˜×”', 'Toyota', '×œ×§×¡×•×¡', 'Lexus',
    '×™×•× ×“××™', 'Hyundai', '×§×™×', 'Kia', '×ž××–×“×”', 'Mazda',
    '×¤×•×œ×§×¡×•×•×’×Ÿ', 'VW', '×¡×§×•×“×”', '×××•×“×™', '×ž×¨×¦×“×¡', 'BMW',
    '×¡×•×–×•×§×™', '×¡×•×‘××¨×•', '×”×•× ×“×”', '× ×™×¡×Ÿ', '×ž×™×¦×•×‘×™×©×™', '×©×‘×¨×•×œ×˜',
    '××•×¤×¨×™×™×˜', '××œ×‘×¨', '×¡×× ×§××¨', '×“×œ×§ ×ž×•×˜×•×¨×¡', '×›×¨×ž×œ', '×§×¨×¡×•',
    '×ž×›×™×¨×•×ª ×¤×¨×•× ×˜×œ×™×•×ª', '×™×¢×“×™×', '×¢×ž×œ×•×ª', '×‘×•× ×•×¡×™×', '×¡×’×™×¨×ª ×¢×¡×§××•×ª',
    '×¨×›×‘ ×—×“×©', '×¨×›×‘ ×ž×©×•×ž×©', '×¨×›×‘ ×—×©×ž×œ×™', '×¨×›×‘ ×”×™×‘×¨×™×“×™'
  ],

  // ============ ×ž×–×•×Ÿ ×•××¤×™×™×” ============
  food: [
    '××•×¤×”', '××•×¤×™×', '××¤×™×™×”', '×ž××¤×™×•×ª', '×œ×—×', '×¤×™×ª×•×ª', '×‘×¦×§', '×ª× ×•×¨',
    '××¤×™×™×” ×ª×¢×©×™×™×ª×™×ª', '×ž××¤×™×', '×¢×•×’×•×ª', '×§×•× ×“×™×˜×•×¨×™×”', '×§×•× ×“×™×˜×•×¨', '×¤×˜×™×¡×¨×™',
    '×‘×•×¨×§×¡', '×¡×ž×‘×•×¡×§', '×œ×—×ž× ×™×•×ª', '×—×œ×•×ª', '×‘××’×˜', '×ž××¤×”',
    '×˜×‘×—', '×˜×‘×—×™×ª', '×©×£', '×¡×• ×©×£', '×©×£ ×¨××©×™', '×¢×•×–×¨ ×˜×‘×—',
    '×¤×¡ ×—×', '×¤×¡ ×§×¨', '×ž×˜×‘×— ×ª×¢×©×™×™×ª×™', '×§×™×™×˜×¨×™× ×’', '×‘×™×©×•×œ', '×”×›× ×ª ××•×›×œ',
    '×§×•×¤××™', '×§×•×¤××™×ª', '×§×•×¤×”', '×ž×›×™×¨×•×ª', '×©×™×¨×•×ª ×œ×§×•×—×•×ª',
    '×ª×¢×©×™×™×ª ×ž×–×•×Ÿ', '×™×™×¦×•×¨ ×ž×–×•×Ÿ', '×ž×¤×¢×œ ×ž×–×•×Ÿ', '×›×©×¨×•×ª', '×”×™×’×™×™× ×”',
    '× ×™×§×™×•×Ÿ', '×¢×‘×•×“×” ×‘×¢×ž×™×“×”', '×ž×©×ž×¨×•×ª', '×¢×‘×•×“×” ×¤×™×–×™×ª',
    '×¢×‘×•×“×” ×‘×¦×•×•×ª', '×¡×‘×œ× ×•×ª', '×œ×œ× × ×™×¡×™×•×Ÿ', '×ž×ª×—×™×œ×™×', '×”×›×©×¨×” ×‘×ž×§×•×'
  ],

  // ============ ×§×ž×¢×•× ××•×ª ============
  retail: [
    '×§×•×¤××™', '×§×•×¤××™×ª', '×§×•×¤×”', '×ž×•×›×¨', '×ž×•×›×¨×ª', '××™×© ×ž×›×™×¨×•×ª', '××©×ª ×ž×›×™×¨×•×ª',
    '×ž× ×”×œ ×—× ×•×ª', '×ž× ×”×œ×ª ×—× ×•×ª', '×¢×•×–×¨ ×ž× ×”×œ', '×ž× ×”×œ ×ž×©×ž×¨×ª', '×¡×“×¨×Ÿ', '×¡×“×¨× ×™×ª',
    '×ž× ×™×•×ª', '×ž× ×™×”', '×ž×ž×œ× ×ž×œ××™', '×ž×–× ×•×Ÿ', '××¨×™×–×”',
    '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×ž×›×™×¨×•×ª', '×™×—×¡ ×œ×œ×§×•×—', '×™×“×¢ ×‘×ž×•×¦×¨×™×', '×”×¤×¢×œ×ª ×§×•×¤×”',
    '×§×•×¤×” ×ž×ž×•×—×©×‘×ª', '××©×¨××™', '×ž×–×•×ž×Ÿ', '×¡×’×™×¨×ª ×§×•×¤×”', '×¡×¤×™×¨×ª ×›×¡×£',
    '×¡×™×“×•×¨ ×¡×—×•×¨×”', '×ª×¦×•×’×”', '×•×™×˜×¨×™× ×”', '×ž×œ××™', '× ×™×”×•×œ ×ž×œ××™',
    '×¡×•×¤×¨×ž×¨×§×˜', '×ž×™× ×™×ž×¨×§×˜', '×—× ×•×ª', '×§× ×™×•×Ÿ', '×ž×¨×›×– ×§× ×™×•×ª',
    '×¨×ž×™ ×œ×•×™', '×©×•×¤×¨×¡×œ', '×ž×’×”', '×•×™×§×˜×•×¨×™', '×™×•×—× × ×•×£', 'AM:PM',
    '××•×©×¨ ×¢×“', '×¡×•×¤×¨ ×¤××¨×', '×§×¡×˜×¨×•', '×¤×•×§×¡', '×¨× ×•××¨', '×’×•×œ×£'
  ],

  // ============ ×”×™×™×˜×§ ============
  hightech: [
    '×ž×¤×ª×—', '×ž×ª×›× ×ª', 'Developer', 'Full Stack', 'Frontend', 'Backend',
    '×ž×”× ×“×¡ ×ª×•×›× ×”', 'Software Engineer', 'DevOps', 'SRE', 'QA', '×‘×•×“×§ ×ª×•×›× ×”',
    '×ž× ×”×œ ×ž×•×¦×¨', 'Product Manager', 'PM', '×ž×¢×¦×‘ UX', '×ž×¢×¦×‘ UI', 'Designer',
    'Data Analyst', 'Data Scientist', '×ž×“×¢×Ÿ × ×ª×•× ×™×', '×× ×œ×™×¡×˜', 'BI',
    'Scrum Master', 'Team Lead', 'Tech Lead', 'CTO', 'VP R&D',
    'JavaScript', 'TypeScript', 'React', 'Angular', 'Vue', 'Node.js',
    'Python', 'Java', 'C#', '.NET', 'C++', 'Go', 'Ruby', 'PHP',
    'AWS', 'Azure', 'GCP', 'Docker', 'Kubernetes', 'CI/CD', 'Git',
    'MongoDB', 'PostgreSQL', 'MySQL', 'Redis',
    'REST', 'GraphQL', 'Microservices', 'API',
    'Agile', 'Scrum', 'Kanban', 'TDD', 'Clean Code'
  ],

  // ============ ×ž×©××‘×™ ×× ×•×© ×•×’×™×•×¡ ============
  hr: [
    '×ž×©××‘×™ ×× ×•×©', 'HR', '×ž×’×™×™×¡', '×ž×’×™×™×¡×ª', 'Recruiter', '×’×™×•×¡',
    'HR Manager', '×ž× ×”×œ ×ž×©××‘×™ ×× ×•×©', 'HR Business Partner', 'HRBP',
    '×¨×›×– ×ž×©××‘×™ ×× ×•×©', '×ž× ×”×œ ×’×™×•×¡', 'Sourcer', 'Talent Acquisition',
    '×¨××™×•× ×•×ª', '×¡×™× ×•×Ÿ ×§×•×¨×•×ª ×—×™×™×', '×’×™×•×¡ High Tech',
    'ATS', 'Comeet', 'Greenhouse', 'Workday',
    '×œ×•×— ×©×›×¨', '× ×•×›×—×•×ª', '×—×•×¤×©×•×ª', '× ×™×”×•×œ ×¢×•×‘×“×™×', 'Onboarding',
    '×¨×•×•×—×”', '×”×“×¨×›×”', '×¤×™×ª×•×— ×ž× ×”×œ×™×', '×ª×¨×‘×•×ª ××¨×’×•× ×™×ª'
  ]
};

async function main() {
  console.log('ðŸš€ ×ž×¢×“×›×Ÿ ×ª×’×™×•×ª ×ž×•×¨×—×‘×•×ª ×œ×›×œ ×”×ž×©×¨×•×ª...\n');
  
  const positions = await prisma.position.findMany({
    include: { employer: true }
  });
  
  let updated = 0;
  
  for (const pos of positions) {
    const titleLower = pos.title.toLowerCase();
    const employerLower = (pos.employer?.name || '').toLowerCase();
    const descLower = (pos.description || '').toLowerCase();
    const fullText = `${titleLower} ${employerLower} ${descLower}`;
    
    const categories = new Set();
    
    // ×œ×¤×™ ×ž×¢×¡×™×§
    if (employerLower.includes('×‘× ×§') || employerLower.includes('×ž×–×¨×—×™')) {
      categories.add('banking');
    }
    if (employerLower.includes('union') || employerLower.includes('gac') || 
        employerLower.includes('××•×¤×¨×™×™×˜') || employerLower.includes('×™×“ ×¨××©×•× ×”')) {
      categories.add('automotive');
      categories.add('sales');
    }
    if (employerLower.includes('yes') || employerLower.includes('×˜×œ×¡×œ')) {
      categories.add('customerService');
      categories.add('sales');
    }
    if (employerLower.includes('×œ×•×’×™×¡×˜×™×§×”') || employerLower.includes('×¡×œ×¢') ||
        employerLower.includes('×œ×•×’×™×¡×˜×™×§×¨') || employerLower.includes('×œ××©×™× ×’') ||
        employerLower.includes('×.×“.×¨') || employerLower.includes('××•×©×¤×™×¨')) {
      categories.add('logistics');
    }
    if (employerLower.includes('×¤×™×ª×”') || employerLower.includes('×ž××¤×™×”') ||
        employerLower.includes('×‘×•×˜×™×§')) {
      categories.add('food');
      categories.add('retail');
    }
    
    // ×œ×¤×™ ×›×•×ª×¨×ª
    if (/×ž×—×¡× ××™|×ž×—×¡×Ÿ|×ž×œ×’×–×”|×œ×™×§×•×˜|××•×¨×–|×œ×•×’×™×¡×˜×™×§×”/.test(fullText)) {
      categories.add('logistics');
    }
    if (/×ž×›×™×¨×•×ª|×ž×•×›×¨|×¡×•×›×Ÿ|××™×© ×©×˜×—|×©×™×ž×•×¨/i.test(fullText)) {
      categories.add('sales');
    }
    if (/×‘× ×§|×¤×™× × ×¡×™|××©×¨××™|×”×©×§×¢×•×ª|×ž×©×›× ×ª×/i.test(fullText)) {
      categories.add('banking');
    }
    if (/×ž×•×§×“|× ×¦×™×’ ×©×™×¨×•×ª|×˜×œ×¤×•× ×™|×§×•×œ ×¡× ×˜×¨|×©×™×¨×•×ª ×œ×§×•×—×•×ª/i.test(fullText)) {
      categories.add('customerService');
    }
    if (/×¨×›×‘|××•×œ×|×ž×›×•× ××™|×œ×§×¡×•×¡|×˜×•×™×•×˜×”|GAC|UNION|×™×“ ×¨××©×•× ×”|×œ×™×¡×™× ×’/i.test(fullText)) {
      categories.add('automotive');
    }
    if (/×˜×‘×—|××¤×™×™×”|××•×¤×”|×ž××¤×™×”|×ž×˜×‘×—|×§×™×™×˜×¨×™× ×’|×¤×™×ª×”/i.test(fullText)) {
      categories.add('food');
    }
    if (/×§×•×¤××™|×—× ×•×ª|×ž×›×™×¨×•×ª ×¤×¨×•× ×˜×œ×™×•×ª|×¡×•×¤×¨×ž×¨×§×˜/i.test(fullText)) {
      categories.add('retail');
    }
    if (/×ž×¤×ª×—|×ª×•×›× ×”|Developer|Full Stack|QA|DevOps/i.test(fullText)) {
      categories.add('hightech');
    }
    if (/×’×™×•×¡|×ž×©××‘×™ ×× ×•×©|HR|×ž×’×™×™×¡/i.test(fullText)) {
      categories.add('hr');
    }
    
    // ×‘×¨×™×¨×ª ×ž×—×“×œ
    if (categories.size === 0) {
      if (/×ž×›×™×¨×•×ª|× ×¦×™×’/i.test(fullText)) {
        categories.add('sales');
        categories.add('customerService');
      } else {
        categories.add('customerService');
      }
    }
    
    // ××™×—×•×“ ×ª×’×™×•×ª
    const allKeywords = new Set();
    
    for (const cat of categories) {
      const keywords = CATEGORY_KEYWORDS[cat] || [];
      keywords.forEach(kw => allKeywords.add(kw));
    }
    
    // ×©×ž×™×¨×ª keywords ×§×™×™×ž×™×
    try {
      const existingKeywords = pos.keywords ? JSON.parse(pos.keywords) : [];
      existingKeywords.forEach(kw => allKeywords.add(kw));
    } catch {}
    
    const finalKeywords = Array.from(allKeywords).slice(0, 150);
    
    await prisma.position.update({
      where: { id: pos.id },
      data: { keywords: JSON.stringify(finalKeywords) }
    });
    
    console.log(`âœ… ${pos.employer?.name} | ${pos.title}`);
    console.log(`   ðŸ“ ${Array.from(categories).join(', ')}`);
    console.log(`   ðŸ·ï¸ ${finalKeywords.length} ×ª×’×™×•×ª`);
    
    updated++;
  }
  
  console.log(`\nðŸŽ‰ ×¢×•×“×›× ×• ${updated} ×ž×©×¨×•×ª ×¢× ×ª×’×™×•×ª ×ž×•×¨×—×‘×•×ª!`);
}

main()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
