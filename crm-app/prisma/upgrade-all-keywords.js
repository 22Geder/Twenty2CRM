const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

/**
 * ðŸ§  ×ž×™×œ×•×Ÿ ×ª×’×™×•×ª ×—×›×ž×•×ª - ×›×ž×• ×ž×’×™×™×¡ ×× ×•×©×™ ×ž×§×¦×•×¢×™
 * 20-30 ×ª×’×™×•×ª ×œ×›×œ ×¡×•×’ ×ž×©×¨×”
 */
const SMART_TAGS = {
  // ==================== ×ž× ×”×œ×™× ×•××—×¨××™× ====================
  ×ž× ×”×œ_××•×œ×: [
    '×ž× ×”×œ', '××•×œ× ×ª×¦×•×’×”', '× ×™×”×•×œ ×¦×•×•×ª', '×™×¢×“×™×', '×ž×›×™×¨×•×ª', '×¨×›×‘',
    '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×ª×¤×¢×•×œ', '× ×™×”×•×œ ×¢×•×‘×“×™×', '×”×›×©×¨×”', '×“×•×—×•×ª',
    '××—×¨×™×•×ª', 'KPI', '×ž×•×˜×™×‘×¦×™×”', '×ž× ×”×™×’×•×ª', '×ª×§×©×•×¨×ª', '×™×—×¡×™ ×¢×‘×•×“×”',
    '×‘×§×¨×”', '×ª×¤×¢×•×œ ×™×•×ž×™×•×ž×™', '× ×™×”×•×œ ×ž×©×ž×¨×•×ª', '×’×™×•×¡', '×”×“×¨×›×”',
    '×¨××© ×¦×•×•×ª', '× ×™×¡×™×•×Ÿ × ×™×”×•×œ×™', '×ž×›×™×¨×•×ª ×¨×›×‘', '×¡×•×›× ×•×ª ×¨×›×‘'
  ],
  ×ž× ×”×œ_××•×œ×_×™×“2: [
    '×ž× ×”×œ', '××•×œ× ×¡×œ×§×˜', '×™×“ ×©× ×™×™×”', '×¨×›×‘', '× ×™×”×•×œ ×¦×•×•×ª', '×ž×›×™×¨×•×ª',
    '×ž×›×™×¨×•×ª ×¨×›×‘ ×ž×©×•×ž×©', '×˜×¨×™×™×“ ××™×Ÿ', '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×ª×¤×¢×•×œ',
    '×“×•×—×•×ª', 'KPI', '××—×¨×™×•×ª', '× ×™×”×•×œ ×¢×•×‘×“×™×', '×ž×•×˜×™×‘×¦×™×”', '×”×›×©×¨×”',
    '×™×¢×“×™×', '×œ×§×¡×•×¡', '×¤×¨×™×ž×™×•×', '×œ×§×•×—×•×ª VIP'
  ],
  ××—×¨××™_×œ×§×•×—_×¢×¡×§×™: [
    '××—×¨××™ ×ª×™×§ ×œ×§×•×—', '×œ×§×•×—×•×ª ×¢×¡×§×™×™×', 'B2B', '× ×™×”×•×œ ×œ×§×•×—×•×ª', '×ž×›×™×¨×•×ª',
    '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×¤×¨×•××§×˜×™×‘', '×ª×§×©×•×¨×ª', '×ž×©× ×•×ž×ª×Ÿ', '×”×¦×¢×•×ª ×ž×—×™×¨',
    '×™×—×¡×™ ×œ×§×•×—×•×ª', '×©×™×ž×•×¨ ×œ×§×•×—×•×ª', 'CRM', '×ž×¢×§×‘', '×¡×’×™×¨×ª ×¢×¡×§××•×ª',
    '×¢×•×œ× ×”×¨×›×‘', '×œ×™×¡×™× ×’', '×œ×™×¡×™× ×’ ×¢×¡×§×™', '×”×©×›×¨×”', '× ×™×”×•×œ ×—×©×‘×•× ×•×ª'
  ],
  
  // ==================== ×œ×•×’×™×¡×˜×™×§×” ×ž×•×¨×—×‘ ====================
  ×¤×§×™×“_×ž×—×¡×Ÿ: [
    '×¤×§×™×“ ×ž×—×¡×Ÿ', '× ×™×”×•×œ ×ž×œ××™', '×§×œ×™×˜×”', '× ×™×¤×•×§', '×ž×¢×¨×›×•×ª ×ž×™×“×¢',
    '××§×¡×œ', '×“×™×•×§', '×¡×“×¨', '××¨×’×•×Ÿ', 'WMS', 'Priority', 'SAP',
    '×ª×™×¢×•×“', '×“×•×—×•×ª', '×ª×™××•×', '×¢×‘×•×“×” ×ž×•×œ ×¡×¤×§×™×', '×œ×•×’×™×¡×˜×™×§×”',
    '×ž×—×¡× ××•×ª', '×¢×‘×•×“×” ×ž×©×¨×“×™×ª', '×¢×‘×•×“×” ×ž×•×œ ×œ×§×•×—×•×ª'
  ],
  ×‘×§×¨_×¡×—×•×¨×”: [
    '×‘×§×¨ ×¡×—×•×¨×”', '×‘×§×¨×ª ×ž×œ××™', '×‘×“×™×§×•×ª', '×¡×¤×™×¨×•×ª ×ž×œ××™', '×“×™×•×§',
    '×“×•×—×•×ª', '×—×¨×™×’×•×ª', 'WMS', '××§×¡×œ', '× ×™×ª×•×— × ×ª×•× ×™×', '×¡×“×¨',
    '×ž×¢×§×‘', '×œ×•×’×™×¡×˜×™×§×”', '×ž×—×¡×Ÿ', '××™×›×•×ª', '×‘×§×¨×”'
  ],
  ×‘×§×¨_×”×–×ž× ×•×ª: [
    '×‘×§×¨ ×”×–×ž× ×•×ª', '× ×™×”×•×œ ×”×–×ž× ×•×ª', '×ª×™××•×', '×œ×§×•×—×•×ª', '×¡×¤×§×™×',
    '×ž×¢×§×‘', '×“×•×—×•×ª', '××§×¡×œ', 'WMS', 'Priority', '×©×™×¨×•×ª ×œ×§×•×—×•×ª',
    '×“×™×•×§', '×¡×“×¨', '×œ×•×’×™×¡×˜×™×§×”', '×ž×—×¡×Ÿ'
  ],
  ×¡×“×¨×Ÿ_×”×¤×¦×”: [
    '×¡×“×¨×Ÿ ×”×¤×¦×”', '×ž×™×•×Ÿ', '×¡×™×“×•×¨', '×ž×—×¡×Ÿ', '×”×¤×¦×”', '×¡×—×•×¨×”',
    '×¢×‘×•×“×” ×¤×™×–×™×ª', '×›×•×©×¨ ×’×•×¤× ×™', '×¢×‘×•×“×” ×‘×¦×•×•×ª', '×ž×©×ž×¨×•×ª',
    '×œ×•×’×™×¡×˜×™×§×”', '×©×™×œ×•×—', '××¨×™×–×”', '××—×¨×™×•×ª'
  ],
  ××—×ž×©_×ž×•×§×“: [
    '××—×ž"×©', '××—×¨××™ ×ž×©×ž×¨×ª', '× ×™×”×•×œ ×ž×©×ž×¨×ª', '×ž×•×§×“', '× ×™×”×•×œ ×¦×•×•×ª',
    '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×ª×¤×¢×•×œ', '×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª', '×ª×§×©×•×¨×ª', '×œ×—×¥',
    '×¨×™×‘×•×™ ×ž×©×™×ž×•×ª', '×“×•×—×•×ª', '××—×¨×™×•×ª', '×”×•×‘×œ×”'
  ],
  ×ž× ×”×œ_×§×œ×™×˜×”: [
    '×ž× ×”×œ ×§×œ×™×˜×”', '×§×œ×™×˜×ª ×¡×—×•×¨×”', '× ×™×”×•×œ ×¦×•×•×ª', '×ž×—×¡×Ÿ', '×œ×•×’×™×¡×˜×™×§×”',
    'WMS', '×‘×§×¨×”', '×ª×™××•×', '×¢×‘×•×“×” ×‘×©×˜×—', '×¡×¤×§×™×', '×ª×¤×¢×•×œ',
    '×“×•×—×•×ª', '××—×¨×™×•×ª', '×¡×“×¨', '××¨×’×•×Ÿ'
  ],
  ×ž×¤×¢×™×œ_WMS: [
    '×ž×¤×¢×™×œ WMS', '×ž×¢×¨×›×ª × ×™×”×•×œ ×ž×—×¡×Ÿ', 'WMS', 'Priority', 'SAP',
    '×ž×—×©×‘', '×“×™×•×§', '×“×•×—×•×ª', '×ž×¢×§×‘', '×œ×•×’×™×¡×˜×™×§×”', '×ž×—×¡×Ÿ',
    '× ×™×ª×•×— × ×ª×•× ×™×', '××§×¡×œ', '×¡×“×¨', '××¨×’×•×Ÿ'
  ],
  ×¨×›×–_×”×¤×¦×”: [
    '×¨×›×– ×”×¤×¦×”', '×ª×™××•× ×”×¤×¦×”', '× ×™×”×•×œ × ×”×’×™×', '×œ×•×’×™×¡×˜×™×§×”', '×ž×¡×œ×•×œ×™×',
    '×ª×›× ×•×Ÿ', '×ž×¢×§×‘', '×œ×§×•×—×•×ª', '×©×™×¨×•×ª', '×“×•×—×•×ª', '×ª×§×©×•×¨×ª',
    '×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª', '×œ×—×¥', '×¨×™×‘×•×™ ×ž×©×™×ž×•×ª'
  ],
  ×¤×§×™×“_×”×¤×¦×”: [
    '×¤×§×™×“ ×”×¤×¦×”', '×ª×™××•× ×ž×©×œ×•×—×™×', '×œ×§×•×—×•×ª', '× ×”×’×™×', '×ž×¢×§×‘',
    '×ž×¢×¨×›×•×ª ×ž×™×“×¢', '××§×¡×œ', '×˜×œ×¤×•×Ÿ', '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×œ×•×’×™×¡×˜×™×§×”',
    '×“×™×•×§', '×¡×“×¨', '×ª×§×©×•×¨×ª'
  ],
  ×¨××©_×¦×•×•×ª: [
    '×¨××© ×¦×•×•×ª', '× ×™×”×•×œ ×¦×•×•×ª', '×”×•×‘×œ×”', '×ž×•×˜×™×‘×¦×™×”', '×™×¢×“×™×',
    '×”×“×¨×›×”', '×¤×™×§×•×—', '×“×•×—×•×ª', '×ª×¤×¢×•×œ', '××—×¨×™×•×ª', '×ª×§×©×•×¨×ª',
    '×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª', '×œ×•×’×™×¡×˜×™×§×”', '×ž×—×¡×Ÿ', '×¢×‘×•×“×” ×‘×¦×•×•×ª'
  ],
  ×ž×¤×¢×™×œ_×—×“×¨_×‘×§×¨×”: [
    '×—×“×¨ ×‘×§×¨×”', '×ž×¤×¢×™×œ', '× ×™×˜×•×¨', '×ž×¢×§×‘', '×ž×¢×¨×›×•×ª', '×“×•×—×•×ª',
    '×ž×©×ž×¨×•×ª', '×œ×™×œ×”', '××—×¨×™×•×ª', '×ª×§×©×•×¨×ª', '×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª',
    '×œ×•×’×™×¡×˜×™×§×”', '×ž×ž×’×•×¨×•×ª', '×ª×¤×¢×•×œ'
  ],

  // ==================== ×©×™×œ×•×— ×•×™×‘×•×/×™×¦×•× ====================
  ×ž×ª××_×™×‘×•×: [
    '×ž×ª×× ×™×‘×•×', '×™×‘×•×', '×©×™×œ×•×—', '×ž×›×¡', '×œ×•×’×™×¡×˜×™×§×” ×‘×™× ×œ××•×ž×™×ª',
    '×¡×¤×§×™×', '×ª×™××•×', '×× ×’×œ×™×ª', '×ž×¡×ž×›×™×', 'freight', 'forwarding',
    'shipping', 'regulations', 'compliance', 'import'
  ],
  ×ž×ª××_×™×¦×•×: [
    '×ž×ª×× ×™×¦×•×', '×™×¦×•×', '×©×™×œ×•×—', '×ž×›×¡', '×œ×•×’×™×¡×˜×™×§×” ×‘×™× ×œ××•×ž×™×ª',
    '×œ×§×•×—×•×ª', '×ª×™××•×', '×× ×’×œ×™×ª', '×ž×¡×ž×›×™×', 'freight', 'forwarding',
    'shipping', 'export', 'documentation'
  ],

  // ==================== ×¨×›×‘ ×ž×•×¨×—×‘ ====================
  ×ª×¤×¢×•×œ_×¨×›×‘: [
    '×ª×¤×¢×•×œ', '×¨×›×‘', '× ×™×”×•×œ ×ž×œ××™', '×¨×›×‘×™×', '×ª×™××•×', '×ž×¢×¨×›×•×ª',
    '×“×™×•×§', '×¡×“×¨', '×¢×‘×•×“×” ×ž×•×œ ×œ×§×•×—×•×ª', '×©×™×¨×•×ª', '×œ×•×’×™×¡×˜×™×§×”',
    '×˜×¨×™×™×“ ××™×Ÿ', '×ž×¡×™×¨×•×ª', '×§×œ×™×˜×ª ×¨×›×‘', '×¡×•×›× ×•×ª ×¨×›×‘'
  ],
  ×ª×•×ž×š_×˜×›× ×™_×¨×›×‘: [
    '×ª×ž×™×›×” ×˜×›× ×™×ª', '×¨×›×‘', 'GEELY', 'ZEEKR', '×—×©×ž×œ×™', '×”×™×‘×¨×™×“×™',
    '××‘×—×•×Ÿ', '×˜×›× ×•×œ×•×’×™×”', '×ž×¢×¨×›×•×ª ×¨×›×‘', '×¤×ª×¨×•×Ÿ ×ª×§×œ×•×ª', '×œ×§×•×—×•×ª',
    '×©×™×¨×•×ª', '×ª×§×©×•×¨×ª', '×¡×‘×œ× ×•×ª', '×™×“×¢ ×˜×›× ×™', '×”×“×¨×›×”'
  ],
  ×‘×•×—×Ÿ_×¨×›×‘: [
    '×‘×•×—×Ÿ ×¨×›×‘', '×‘×“×™×§×•×ª ×¨×›×‘', '× ×¡×™×¢×•×ª ×ž×‘×—×Ÿ', '××™×ª×•×¨ ×ª×§×œ×•×ª',
    '×˜×›× ×™', '×ž×›×•× ××•×ª', '× ×”×™×’×”', '×‘×˜×™×—×•×ª', '×“×™×•×§', '××—×¨×™×•×ª',
    '×¨×™×©×™×•×Ÿ', '× ×™×¡×™×•×Ÿ ×‘×¨×›×‘', '×¡×•×›× ×•×ª ×¨×›×‘'
  ],
  ×™×•×¢×¥_×©×™×¨×•×ª_× ×•×¡×£: [
    '×™×•×¢×¥ ×©×™×¨×•×ª', '×©×™×¨×•×ª ×œ×§×•×—×•×ª', '×¨×›×‘', '×ž×•×¡×š', '×ª×™××•×',
    '×œ×§×•×—×•×ª', '×˜×™×¤×•×œ×™×', '×ž×¢×§×‘', '×”×¦×¢×•×ª ×ž×—×™×¨', 'CRM',
    '×ª×§×©×•×¨×ª', '××ž×¤×ª×™×”', '×ž×›×™×¨×•×ª', '×©×™×¨×•×ª ×¤×¨×™×ž×™×•×'
  ],

  // ==================== ×‘× ×§××•×ª ====================
  ×˜×œ×¨: [
    // ×ª×¤×§×™×“
    "×˜×œ×¨", "×˜×œ×¨×™×ª", "×§×•×¤××™ ×‘× ×§", "× ×¦×™×’ ×§×•×¤×”",
    // ×ž×§×•× ×¢×‘×•×“×”
    "×‘× ×§", "×‘× ×§××•×ª", "×ž×•×¡×“ ×¤×™× × ×¡×™", "×¡× ×™×£ ×‘× ×§",
    // ×ž×™×•×ž× ×•×™×•×ª
    "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "×¢×‘×•×“×” ×¢× ×ž×–×•×ž×Ÿ", "×”×¤×§×“×•×ª", "×ž×©×™×›×•×ª", "×©×™×§×™×", "×”×¢×‘×¨×•×ª",
    "×ž×˜\"×—", "CRM", "×§×•×¤×” ×¨×•×©×ž×ª", "×¡×¤×™×¨×ª ×›×¡×£", "×“×™×•×§ ×’×‘×•×”",
    // ×¨×§×¢ ×ž×ª××™×
    "×ž×›×™×¨×•×ª", "×©×™×¨×•×ª ×¤×¨×•× ×˜×œ×™", "×§×•×¤××™", "×§×•×¤××™×ª", "×§×ž×¢×•× ××•×ª", "retail",
    // ×ª×›×•× ×•×ª
    "×™×™×¦×•×’×™×•×ª", "××ž×™× ×•×ª", "×¢×‘×•×“×” ×‘×œ×—×¥", "×§×©×‘ ×œ×œ×§×•×—", "×¡×‘×œ× ×•×ª",
    // ×¨×ž×ª ×›× ×™×¡×”
    "×œ×œ× × ×™×¡×™×•×Ÿ", "×ž×ª×—×™×œ×™×", "entry level", "×¦×¢×™×¨×™×", "×¡×˜×•×“× ×˜×™×", "×¢×‘×•×“×” ×¨××©×•× ×”"
  ],
  
  ×‘× ×§××™_×œ×§×•×—×•×ª: [
    // ×ª×¤×§×™×“
    "×‘× ×§××™", "×‘× ×§××™×ª", "×‘× ×§××™ ×œ×§×•×—×•×ª", "banker", "×™×•×¢×¥ ×‘× ×§××™",
    // ×ž×§×•× ×¢×‘×•×“×”
    "×‘× ×§", "×‘× ×§××•×ª", "×ž×•×¡×“ ×¤×™× × ×¡×™", "×¡× ×™×£ ×‘× ×§", "×ž×¨×›×– ×¢×¡×§×™×",
    // ×ž×™×•×ž× ×•×™×•×ª
    "×¢×•\"×©", "××©×¨××™", "×”×©×§×¢×•×ª", "×¤×™×§×“×•× ×•×ª", "× ×™\"×¢", "CRM", "×ž×›×™×¨×•×ª",
    "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "× ×™×”×•×œ ×ª×™×§ ×œ×§×•×—×•×ª", "×’×™×•×¡ ×œ×§×•×—×•×ª",
    // ×¨×§×¢ ×ž×ª××™×
    "×ž×›×™×¨×•×ª ×¤×™× × ×¡×™×•×ª", "×™×•×¢×¥ ×¤× ×¡×™×•× ×™", "×¡×•×›×Ÿ ×‘×™×˜×•×—", "×ž×•×§×“ ×ž×›×™×¨×•×ª",
    // ×ª×›×•× ×•×ª
    "×™×›×•×œ×ª ×ž×›×™×¨×ª×™×ª", "×©×›× ×•×¢", "×™×—×¡×™ ×× ×•×©", "×™×™×¦×•×’×™×•×ª", "××ž×™× ×•×ª"
  ],
  
  ×‘× ×§××™_×ž×©×›× ×ª××•×ª: [
    "×‘× ×§××™", "×‘× ×§××™×ª", "×ž×©×›× ×ª××•×ª", "mortgage", "×”×œ×•×•××•×ª × ×“×œ\"×Ÿ",
    "× ×“×œ\"×Ÿ", "×™×™×¢×•×¥ ×ž×©×›× ×ª×", "×ž×™×ž×•×Ÿ × ×“×œ\"×Ÿ", "×‘× ×§", "×ž×•×¡×“ ×¤×™× × ×¡×™",
    "×—×™×ª×•×", "×”×¢×¨×›×ª ×¡×™×›×•× ×™×", "× ×™×ª×•×— ××©×¨××™", "×©×ž××•×ª",
    "×ª×©×œ×•×ž×™ ×ž×©×›× ×ª×", "×¨×™×‘×™×ª", "×œ×•×— ×¡×™×œ×•×§×™×Ÿ", "×”×•×Ÿ ×¢×¦×ž×™", "LTV",
    "×¢×•\"×“ × ×“×œ\"×Ÿ", "×¨×•×›×©×™ ×“×™×¨×”", "×ž×©×§×™×¢×™ × ×“×œ\"×Ÿ", "×™×•×¢×¥ ×ž×©×›× ×ª××•×ª"
  ],
  
  // ==================== ×ž×›×™×¨×•×ª ====================
  ×¡×•×›×Ÿ_×©×˜×—: [
    // ×ª×¤×§×™×“
    "×¡×•×›×Ÿ ×©×˜×—", "×¡×•×›× ×ª ×©×˜×—", "××™×© ×©×˜×—", "××©×ª ×©×˜×—", "× ×¦×™×’ ×©×˜×—",
    "×¡×•×›×Ÿ ×ž×›×™×¨×•×ª", "××™×© ×ž×›×™×¨×•×ª", "field sales", "sales rep",
    // ×ž×™×•×ž× ×•×™×•×ª
    "×ž×›×™×¨×•×ª", "×¤×™×ª×•×— ×¢×¡×§×™", "×’×™×•×¡ ×œ×§×•×—×•×ª", "× ×™×”×•×œ ×ª×™×§ ×œ×§×•×—×•×ª",
    "×ž×©× ×•×ž×ª×Ÿ", "×¡×’×™×¨×ª ×¢×¡×§××•×ª", "×™×¢×“×™×", "×¢×ž×œ×•×ª", "×‘×•× ×•×¡×™×",
    "B2B", "B2C", "×ž×›×™×¨×•×ª ×©×˜×—", "× ×™×™×“×•×ª", "×”×ª× ×™×™×“×•×ª",
    // ×¨×§×¢ ×ž×ª××™×  
    "×ž×›×™×¨×•×ª ×¤×¨×•× ×˜×œ×™×•×ª", "×¡×•×›×Ÿ ×‘×™×˜×•×—", "× ×¦×™×’ ×ž×›×™×¨×•×ª", "×ž×•×§×“×Ÿ ×ž×›×™×¨×•×ª",
    "×˜×œ×ž×¨×§×˜×™× ×’", "×¡×•×›×Ÿ × ×¡×™×¢×•×ª", "× ×“×œ\"×Ÿ", "×ž×ª×•×•×š",
    // ×“×¨×™×©×•×ª
    "×¨×™×©×™×•×Ÿ × ×”×™×’×”", "×¨×›×‘", "× ×™×™×“×•×ª ×’×‘×•×”×”", "×¢×¦×ž××•×ª",
    // ×ª×›×•× ×•×ª
    "×™×•×–×ž×”", "×ª×—×¨×•×ª×™×•×ª", "××¡×¨×˜×™×‘×™×•×ª", "×©×›× ×•×¢", "×™×—×¡×™ ×× ×•×© ×ž×¢×•×œ×™×"
  ],
  
  × ×¦×™×’_×ž×›×™×¨×•×ª_×˜×œ×¤×•× ×™: [
    // ×ª×¤×§×™×“
    "× ×¦×™×’ ×ž×›×™×¨×•×ª", "×ž×•×§×“×Ÿ ×ž×›×™×¨×•×ª", "×˜×œ×ž×¨×§×˜×™× ×’", "×˜×œ×¡×™×™×œ", "telesales",
    // ×ž×™×•×ž× ×•×™×•×ª
    "×ž×›×™×¨×•×ª ×˜×œ×¤×•× ×™×•×ª", "×©×™×—×•×ª ×™×•×¦××•×ª", "×œ×™×“×™×", "×¡×’×™×¨×ª ×¢×¡×§××•×ª",
    "×ž×©× ×•×ž×ª×Ÿ", "×”×¦×’×ª ×ž×•×¦×¨", "×”×ª×ž×•×“×“×•×ª ×¢× ×”×ª× ×’×“×•×™×•×ª",
    // ×ž×§×•× ×¢×‘×•×“×”
    "×ž×•×§×“ ×ž×›×™×¨×•×ª", "call center", "×ž×•×§×“ ×˜×œ×¤×•× ×™",
    // ×¨×§×¢ ×ž×ª××™×
    "×ž×•×§×“×Ÿ", "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "×ž×›×™×¨×•×ª", "×˜×œ×ž×¨×§×˜×™× ×’",
    // ×ª× ××™×
    "×™×¢×“×™×", "×¢×ž×œ×•×ª", "×‘×•× ×•×¡×™×", "×©×›×¨+×¢×ž×œ×•×ª",
    // ×¨×ž×ª ×›× ×™×¡×”
    "×œ×œ× × ×™×¡×™×•×Ÿ", "×ž×ª×—×™×œ×™×", "entry level", "×¦×¢×™×¨×™×", "×¡×˜×•×“× ×˜×™×",
    "×›× ×™×¡×” ×œ×©×•×§ ×”×¢×‘×•×“×”", "×¢×‘×•×“×” ×¨××©×•× ×”", "×œ×œ× ×ª×•××¨"
  ],
  
  // ==================== ×¨×›×‘ ====================
  ×ž×›×™×¨×•×ª_×¨×›×‘: [
    // ×ª×¤×§×™×“
    "××™×© ×ž×›×™×¨×•×ª ×¨×›×‘", "×¡×•×›×Ÿ ×ž×›×™×¨×•×ª ×¨×›×‘", "×ž×›×™×¨×•×ª ×¨×›×‘", "car sales",
    // ×ž×™×§×•×
    "××•×œ× ×ª×¦×•×’×”", "×©×•××•×¨×•×", "showroom", "×¡×•×›× ×•×ª ×¨×›×‘",
    // ×ž×™×•×ž× ×•×™×•×ª
    "×ž×›×™×¨×•×ª ×¤×¨×•× ×˜×œ×™×•×ª", "×ž×©× ×•×ž×ª×Ÿ", "×˜×¨×™×™×“ ××™×Ÿ", "trade-in",
    "×ž×™×ž×•×Ÿ ×¨×›×‘", "×œ×™×¡×™× ×’", "×‘×™×˜×•×— ×¨×›×‘", "×¢×¡×§××•×ª ×¨×›×‘",
    "×”×¦×’×ª ×¨×›×‘", "× ×¡×™×¢×•×ª ×”×ª×¨×©×ž×•×ª", "test drive", "×ž×¡×™×¨×ª ×¨×›×‘",
    // ×ž×•×ª×’×™×
    "×˜×•×™×•×˜×”", "×œ×§×¡×•×¡", "GEELY", "ZEEKR", "×ž××–×“×”", "×™×•× ×“××™",
    // ×¨×§×¢ ×ž×ª××™×
    "×¡×•×›×Ÿ ×©×˜×—", "×ž×›×™×¨×•×ª B2C", "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "×§×ž×¢×•× ××•×ª",
    // ×ª×›×•× ×•×ª
    "×™×™×¦×•×’×™×•×ª ×’×‘×•×”×”", "×©×™×¨×•×ª×™×•×ª", "×¡×‘×œ× ×•×ª", "×™×“×¢ ×‘×¨×›×‘×™×", "×¨×™×©×™×•×Ÿ × ×”×™×’×”"
  ],
  
  ×™×•×¢×¥_×©×™×¨×•×ª_×¨×›×‘: [
    "×™×•×¢×¥ ×©×™×¨×•×ª", "service advisor", "×ž×•×¡×š", "×©×™×¨×•×ª ×¨×›×‘",
    "×ª×™××•× ×ª×™×§×•× ×™×", "×§×‘×œ×ª ×œ×§×•×—×•×ª", "×”×¦×¢×•×ª ×ž×—×™×¨", "×˜×™×¤×•×œ×™ ×¨×›×‘",
    "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "×ª×§×©×•×¨×ª ×‘×™× ××™×©×™×ª", "×”×¡×‘×¨ ×˜×›× ×™",
    "×ž×›×™×¨×•×ª × ×œ×•×•×ª", "upsale", "×©×™×¨×•×ª after-sale",
    "×¨×›×‘", "automotive", "×ž×›×•× ××•×ª", "×ª×—×–×•×§×ª ×¨×›×‘"
  ],
  
  ×§×‘×œ×”_×¨×›×‘: [
    "× ×¦×™×’ ×§×‘×œ×”", "× ×¦×™×’×ª ×§×‘×œ×”", "×“×™×™×œ ×§×‘×œ×”", "×“×™×™×œ×ª ×§×‘×œ×”", "receptionist",
    "××•×œ× ×ª×¦×•×’×”", "×¡×•×›× ×•×ª ×¨×›×‘", "×©×•××•×¨×•×", "×§×‘×œ×ª ×œ×§×•×—×•×ª", "×¤×¨×•× ×˜",
    "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "××™×¨×•×—", "×™×™×¦×•×’×™×•×ª", "×ª×§×©×•×¨×ª ×˜×œ×¤×•× ×™×ª",
    "×ª×™××•× ×¤×’×™×©×•×ª", "× ×™×”×•×œ ×™×•×ž×Ÿ", "×ž×™×™×œ×™×", "××•×¤×™×¡",
    "×¨×›×‘", "automotive", "GEELY", "×œ×§×¡×•×¡", "×˜×•×™×•×˜×”"
  ],
  
  // ==================== ×œ×•×’×™×¡×˜×™×§×” ====================
  ×ž×—×¡× ××™: [
    // ×ª×¤×§×™×“
    "×ž×—×¡× ××™", "×ž×—×¡× ××™×ª", "×¢×•×‘×“ ×ž×—×¡×Ÿ", "warehouse worker",
    // ×ž×™×•×ž× ×•×™×•×ª
    "×§×‘×œ×ª ×¡×—×•×¨×”", "×¡×™×“×•×¨ ×ž×—×¡×Ÿ", "× ×™×”×•×œ ×ž×œ××™", "×¡×¤×™×¨×•×ª ×ž×œ××™",
    "×ž×¡×•×¤×•×Ÿ", "×¡×•×¨×§", "WMS", "×ž×¢×¨×›×ª ×ž×ž×•×—×©×‘×ª", "××§×¡×œ",
    // ×ž×§×•× ×¢×‘×•×“×”
    "×ž×—×¡×Ÿ", "×ž×¨×œ×•\"×’", "×ž×¨×›×– ×œ×•×’×™×¡×˜×™", "×ž×—×¡×Ÿ ××•×˜×•×ž×˜×™",
    // ×¨×§×¢ ×ž×ª××™×
    "×œ×•×’×™×¡×˜×™×§×”", "×ž×œ×§×˜", "×¡×™×“×•×¨ ×¡×—×•×¨×”", "×¢×•×‘×“ ×™×™×¦×•×¨",
    // ×“×¨×™×©×•×ª
    "×¢×‘×•×“×” ×¤×™×–×™×ª", "×¢×ž×™×“×” ×ž×ž×•×©×›×ª", "× ×›×•× ×•×ª ×œ×ž×©×ž×¨×•×ª", "×’×ž×™×©×•×ª",
    // ×¨×ž×ª ×›× ×™×¡×”
    "×œ×œ× × ×™×¡×™×•×Ÿ", "×ž×ª×—×™×œ×™×", "entry level"
  ],
  
  ×ž×œ×’×–×Ÿ: [
    "×ž×œ×’×–×Ÿ", "×ž×œ×’×–× ×™×ª", "×ž×¤×¢×™×œ ×ž×œ×’×–×”", "forklift operator",
    "×¨×™×©×™×•×Ÿ ×ž×œ×’×–×”", "×ž×œ×’×–×ª ×”×™×’×©", "reach truck", "×ž×œ×’×–×” ×—×©×ž×œ×™×ª",
    "×¢×’×œ×” ×ž×©×˜×—×™×", "pallet jack", "×’'×§ ×—×©×ž×œ×™",
    "×ž×—×¡×Ÿ", "×œ×•×’×™×¡×˜×™×§×”", "×”×¢×ž×¡×”", "×¤×¨×™×§×”", "×¡×™×“×•×¨ ×ž×©×˜×—×™×",
    "×¢×‘×•×“×” ×‘×’×•×‘×”", "×ž×“×¤×™×", "×ž×—×¡×Ÿ ×ž×ž×•×—×©×‘", "WMS",
    "×‘×˜×™×—×•×ª", "×–×”×™×¨×•×ª", "×“×™×•×§"
  ],

  ×ž×œ×§×˜: [
    "×ž×œ×§×˜", "×ž×œ×§×˜×ª", "picker", "×œ×™×§×•×˜", "order picker",
    "×ž×¡×•×¤×•×Ÿ", "×¡×•×¨×§", "×”×–×ž× ×•×ª", "××¨×™×–×”", "packing",
    "×ž×—×¡×Ÿ", "×ž×¨×œ×•\"×’", "×œ×•×’×™×¡×˜×™×§×”", "×”×¤×¦×”",
    "×¢×‘×•×“×” ×¤×™×–×™×ª", "×¢×ž×™×“×” ×ž×ž×•×©×›×ª", "×ž×”×™×¨×•×ª", "×“×™×•×§",
    "×¢×‘×•×“×” ×‘×ž×©×ž×¨×•×ª", "×ž×©×ž×¨×ª ×œ×™×œ×”", "×ž×©×ž×¨×ª ×‘×•×§×¨"
  ],
  
  × ×”×’_×”×¤×¦×”: [
    "× ×”×’", "× ×”×’ ×”×¤×¦×”", "× ×”×’ ×—×œ×•×§×”", "delivery driver",
    "×¨×™×©×™×•×Ÿ B", "×¨×™×©×™×•×Ÿ C", "×¨×™×©×™×•×Ÿ C1", "×ž×©××™×ª",
    "×—×œ×•×§×ª ×¡×—×•×¨×”", "×ž×©×œ×•×—×™×", "×”×¤×¦×”", "last mile",
    "× ×™×•×•×˜", "Waze", "GPS", "×§×•×•×™ ×—×œ×•×§×”", "×œ×§×•×—×•×ª",
    "×¤×¨×™×§×” ×•×˜×¢×™× ×”", "×©×™× ×•×¢", "×”×•×‘×œ×”",
    "×œ×•×’×™×¡×˜×™×§×”", "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "××—×¨×™×•×ª"
  ],
  
  ×¨×¤×¨× ×˜_×©×˜×—: [
    "×¨×¤×¨× ×˜", "×¨×¤×¨× ×˜×™×ª", "×¨×¤×¨× ×˜ ×©×˜×—", "×ª×™××•× ×©×˜×—",
    "×¢×‘×•×“×” ×‘×©×˜×—", "×‘×™×§×•×¨ ×œ×§×•×—×•×ª", "×§×©×¨ ×¢× ×œ×§×•×—×•×ª",
    "×œ×•×’×™×¡×˜×™×§×”", "×”×¤×¦×”", "×ª×¤×¢×•×œ", "×‘×§×¨×ª ××™×›×•×ª",
    "×ª×™××•×", "×“×™×•×•×—", "×ž×¢×§×‘", "×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª",
    "×¨×™×©×™×•×Ÿ × ×”×™×’×”", "× ×™×™×“×•×ª", "×¢×¦×ž××•×ª"
  ],
  
  // ==================== ×©×™×¨×•×ª ×œ×§×•×—×•×ª ====================
  × ×¦×™×’_×©×™×¨×•×ª: [
    "× ×¦×™×’ ×©×™×¨×•×ª", "× ×¦×™×’×ª ×©×™×¨×•×ª", "×ž×•×§×“×Ÿ", "×ž×•×§×“× ×™×ª",
    "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "customer service", "×ž×•×§×“ ×©×™×¨×•×ª", "call center",
    "×ž×¢× ×” ×˜×œ×¤×•× ×™", "×˜×™×¤×•×œ ×‘×¤× ×™×•×ª", "×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª",
    "×©×™×—×•×ª × ×›× ×¡×•×ª", "inbound", "CRM", "×ž×¢×¨×›×ª × ×™×”×•×œ ×œ×§×•×—×•×ª",
    "×¡×‘×œ× ×•×ª", "××ž×¤×ª×™×”", "×©×™×¨×•×ª×™×•×ª", "×”×§×©×‘×”",
    "×¢×‘×•×“×” ×‘×ž×©×ž×¨×•×ª", "×’×ž×™×©×•×ª", "×¢×‘×•×“×” ×‘×œ×—×¥"
  ],
  
  ×ª×ž×™×›×”_×˜×›× ×™×ª: [
    "×ª×ž×™×›×” ×˜×›× ×™×ª", "technical support", "helpdesk", "help desk",
    "××™×© ×ª×ž×™×›×”", "×˜×›× ××™ ×ª×ž×™×›×”", "×¤×ª×¨×•×Ÿ ×ª×§×œ×•×ª",
    "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "×”×¡×‘×¨ ×˜×›× ×™", "×ž×•×§×“ ×ª×ž×™×›×”",
    "×ž×—×©×‘×™×", "×ª×•×›× ×”", "×—×•×ž×¨×”", "×¨×©×ª×•×ª", "IT",
    "×˜×œ×•×•×™×–×™×”", "××™× ×˜×¨× ×˜", "×¡×œ×•×œ×¨", "×ª×§×©×•×¨×ª"
  ],
  
  // ==================== × ×ž×œ ====================
  ×¢×•×‘×“_× ×ž×œ: [
    "×¡×•×•×¨", "×œ××©×™× ×’", "lashing", "× ×ž×œ", "port",
    "×¢×‘×•×“×ª × ×ž×œ", "×ž×›×•×œ×•×ª", "containers", "××•× ×™×•×ª",
    "×¢×‘×•×“×” ×¤×™×–×™×ª", "×¢×‘×•×“×” ×‘×’×•×‘×”", "×¢×‘×•×“×” ×‘×ž×©×ž×¨×•×ª",
    "××ª×ª", "××™×ª×•×ª", "×¤×™× ×¨", "×˜×œ×ž×Ÿ", "×ž×•× ×”",
    "×‘×˜×™×—×•×ª", "×¢×‘×•×“×” ×§×©×”", "×›×•×©×¨ ×’×•×¤× ×™"
  ],
  
  // ==================== ×¤×™× × ×¡×™× ====================
  ×ž× ×”×œ_×—×©×‘×•× ×•×ª: [
    "×ž× ×”×œ ×—×©×‘×•× ×•×ª", "×ž× ×”×œ×ª ×—×©×‘×•× ×•×ª", "×”× ×”×œ×ª ×—×©×‘×•× ×•×ª", "bookkeeper",
    "×—×©×‘×•× ××•×ª", "×¨×•××” ×—×©×‘×•×Ÿ", "accountant",
    "×—×©×‘×•× ×™×•×ª", "×’×‘×™×™×”", "×ª×©×œ×•×ž×™×", "×¡×¤×§×™×", "×œ×§×•×—×•×ª",
    "×ž×¢\"×ž", "×ž×¡ ×”×›× ×¡×”", "×“×•×—×•×ª ×›×¡×¤×™×™×",
    "××§×¡×œ", "Excel", "×¤×¨×™×•×¨×™×˜×™", "Priority", "SAP",
    "×“×™×•×§", "××—×¨×™×•×ª", "×™×¡×•×“×™×•×ª"
  ],
  
  // ==================== ××—×–×§×” ×•×˜×›× ×™ ====================
  ××™×©_×ª×—×–×•×§×”: [
    "××™×© ×ª×—×–×•×§×”", "××©×ª ×ª×—×–×•×§×”", "×˜×›× ××™", "×˜×›× ××™×ª",
    "×ª×—×–×•×§×”", "maintenance", "××—×–×§×”", "×ª×™×§×•× ×™×",
    "×—×©×ž×œ", "××™× ×¡×˜×œ×¦×™×”", "×¦× ×¨×ª", "×ž×™×–×•×’ ××•×•×™×¨",
    "×™×“×™×™× ×˜×•×‘×•×ª", "×™×›×•×œ×ª ×˜×›× ×™×ª", "×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª",
    "×¦×™×•×“", "×›×œ×™ ×¢×‘×•×“×”", "×‘×˜×™×—×•×ª"
  ],
  
  ×ª×•×ž×š_×˜×›× ×™_×¨×›×‘: [
    "×ª×•×ž×š ×˜×›× ×™", "technical support", "×¢×•×œ× ×”×¨×›×‘", "automotive",
    "×ž×•×¡×š", "×ž××‘×—×Ÿ", "××‘×—×•×Ÿ ×ª×§×œ×•×ª", "diagnostics",
    "×”× ×“×¡××™ ×¨×›×‘", "×—×©×ž×œ××™ ×¨×›×‘", "×˜×›× ××™ ×¨×›×‘",
    "PDI", "×”×›× ×” ×œ×ž×¡×™×¨×”", "×‘×§×¨×ª ××™×›×•×ª",
    "×× ×’×œ×™×ª ×˜×›× ×™×ª", "×§×¨×™××ª ×©×¨×˜×•×˜×™×", "×“×•×—×•×ª"
  ],
  
  // ==================== ×ž×–×•×Ÿ ====================
  ×¢×•×‘×“_×ž×–×•×Ÿ: [
    "××•×¤×”", "×ž××¤×™×™×”", "××¤×™×™×”", "×‘×™×™×§×¨", "baker",
    "×ž×–×•×Ÿ", "food", "×ž×˜×‘×—", "kitchen",
    "×¢×‘×•×“×” ×‘×ž×©×ž×¨×•×ª", "×ž×©×ž×¨×ª ×œ×™×œ×”", "×ž×©×ž×¨×ª ×‘×•×§×¨",
    "×¢×ž×™×“×” ×ž×ž×•×©×›×ª", "×¢×‘×•×“×” ×¤×™×–×™×ª",
    "×§×•×¤××™", "×©×™×¨×•×ª ×œ×§×•×—×•×ª", "×ž×›×™×¨×•×ª"
  ]
};

/**
 * ×§×‘×™×¢×ª ×¡×•×’ ×”×ž×©×¨×” ×œ×¤×™ ×›×•×ª×¨×ª
 */
function getPositionType(title, employer) {
  const titleLower = title.toLowerCase();
  
  // ×ž× ×”×œ×™×
  if (titleLower.includes('×ž× ×”×œ') && titleLower.includes('××•×œ×') && (titleLower.includes('×¡×œ×§×˜') || titleLower.includes('×™×“ 2'))) return '×ž× ×”×œ_××•×œ×_×™×“2';
  if (titleLower.includes('×ž× ×”×œ') && titleLower.includes('××•×œ×')) return '×ž× ×”×œ_××•×œ×';
  if (titleLower.includes('×ž× ×”×œ') && titleLower.includes('×§×œ×™×˜×”')) return '×ž× ×”×œ_×§×œ×™×˜×”';
  if (titleLower.includes('×¨××© ×¦×•×•×ª')) return '×¨××©_×¦×•×•×ª';
  
  // ××—×¨××™×
  if (titleLower.includes('××—×¨××™') && titleLower.includes('×œ×§×•×—') && titleLower.includes('×¢×¡×§×™')) return '××—×¨××™_×œ×§×•×—_×¢×¡×§×™';
  if (titleLower.includes('××—×ž"×©') || titleLower.includes('××—×¨××™ ×ž×©×ž×¨×ª')) return '××—×ž×©_×ž×•×§×“';
  
  // ×™×‘×•×/×™×¦×•×
  if (titleLower.includes('×ž×ª××') && titleLower.includes('×™×‘×•×')) return '×ž×ª××_×™×‘×•×';
  if (titleLower.includes('×ž×ª××') && titleLower.includes('×™×¦×•×')) return '×ž×ª××_×™×¦×•×';
  
  // ×‘× ×§××•×ª
  if (titleLower.includes('×˜×œ×¨')) return '×˜×œ×¨';
  if (titleLower.includes('×‘× ×§××™ ×ž×©×›× ×ª××•×ª')) return '×‘× ×§××™_×ž×©×›× ×ª××•×ª';
  if (titleLower.includes('×‘× ×§××™')) return '×‘× ×§××™_×œ×§×•×—×•×ª';
  
  // ×ž×›×™×¨×•×ª
  if (titleLower.includes('×¡×•×›×Ÿ') && titleLower.includes('×©×˜×—')) return '×¡×•×›×Ÿ_×©×˜×—';
  if ((titleLower.includes('×ž×›×™×¨×•×ª') && titleLower.includes('×˜×œ×¡×œ')) || titleLower.includes('×˜×œ×ž×¨×§×˜×™× ×’')) return '× ×¦×™×’_×ž×›×™×¨×•×ª_×˜×œ×¤×•× ×™';
  
  // ×¨×›×‘  
  if ((titleLower.includes('×ž×›×™×¨×•×ª') || titleLower.includes('×¡×•×›×Ÿ')) && 
      (employer.includes('UNION') || employer.includes('×™×“ ×¨××©×•× ×”') || employer.includes('××•×¤×¨×™×™×˜') || 
       titleLower.includes('×¨×›×‘') || titleLower.includes('geely') || titleLower.includes('zeekr') || 
       titleLower.includes('×œ×§×¡×•×¡') || titleLower.includes('×˜×•×™×•×˜×”'))) return '×ž×›×™×¨×•×ª_×¨×›×‘';
  if (titleLower.includes('×™×•×¢×¥ ×©×™×¨×•×ª') || titleLower.includes('×™×•×¢×¦/×ª ×©×™×¨×•×ª') || titleLower.includes('×™×•×¢×¥/×ª ×©×™×¨×•×ª') ||
      (titleLower.includes('×™×•×¢×¦') && !titleLower.includes('×™×‘×•×') && !titleLower.includes('×™×¦×•×'))) return '×™×•×¢×¥_×©×™×¨×•×ª_× ×•×¡×£';
  if ((titleLower.includes('×§×‘×œ×”') || titleLower.includes('×“×™×™×œ')) && 
      (employer.includes('UNION') || titleLower.includes('geely') || titleLower.includes('×œ×§×¡×•×¡'))) return '×§×‘×œ×”_×¨×›×‘';
  if ((titleLower.includes('×ª×•×ž×š') || titleLower.includes('×ª×•×ž×›')) && titleLower.includes('×˜×›× ×™')) return '×ª×•×ž×š_×˜×›× ×™_×¨×›×‘';
  if (titleLower.includes('×ž×ª××') && titleLower.includes('×ž×›×™×¨×•×ª')) return '×ž×›×™×¨×•×ª_×¨×›×‘';
  if (titleLower.includes('×”×ª×¨×©×ž×•×ª')) return '×§×‘×œ×”_×¨×›×‘';
  if (titleLower.includes('×¨×¤×¨× ×˜') && titleLower.includes('×ª×¤×¢×•×œ')) return '×ª×¤×¢×•×œ_×¨×›×‘';
  if (titleLower.includes('×‘×•×—×Ÿ') && titleLower.includes('×¨×›×‘')) return '×‘×•×—×Ÿ_×¨×›×‘';
  if (titleLower.includes('×ª×¤×¢×•×œ') && (employer.includes('UNION') || employer.includes('×™×“ ×¨××©×•× ×”') || employer.includes('××•×¤×¨×™×™×˜'))) return '×ª×¤×¢×•×œ_×¨×›×‘';
  
  // ×œ×•×’×™×¡×˜×™×§×” ×ž×•×¨×—×‘
  if (titleLower.includes('×¤×§×™×“') && titleLower.includes('×ž×—×¡×Ÿ')) return '×¤×§×™×“_×ž×—×¡×Ÿ';
  if (titleLower.includes('×¤×§×™×“') && titleLower.includes('×ž×œ××™')) return '×¤×§×™×“_×ž×—×¡×Ÿ';
  if (titleLower.includes('×¤×§×™×“') && titleLower.includes('×”×¤×¦×”')) return '×¤×§×™×“_×”×¤×¦×”';
  if (titleLower.includes('×‘×§×¨') && titleLower.includes('×¡×—×•×¨×”')) return '×‘×§×¨_×¡×—×•×¨×”';
  if (titleLower.includes('×‘×§×¨') && titleLower.includes('×”×–×ž× ×•×ª')) return '×‘×§×¨_×”×–×ž× ×•×ª';
  if (titleLower.includes('×¡×“×¨×Ÿ')) return '×¡×“×¨×Ÿ_×”×¤×¦×”';
  if (titleLower.includes('×¨×›×–') && titleLower.includes('×”×¤×¦×”')) return '×¨×›×–_×”×¤×¦×”';
  if (titleLower.includes('×ž×¤×¢×™×œ') && titleLower.includes('wms')) return '×ž×¤×¢×™×œ_WMS';
  if (titleLower.includes('×ž×¤×¢×™×œ×ª') && titleLower.includes('wms')) return '×ž×¤×¢×™×œ_WMS';
  if (titleLower.includes('×—×“×¨ ×‘×§×¨×”') || titleLower.includes('×ž×¤×¢×™×œ') && titleLower.includes('×‘×§×¨×”')) return '×ž×¤×¢×™×œ_×—×“×¨_×‘×§×¨×”';
  
  // ×œ×•×’×™×¡×˜×™×§×”
  if (titleLower.includes('×ž×—×¡× ××™') || titleLower.includes('×¢×•×‘×“ ×ž×—×¡×Ÿ')) return '×ž×—×¡× ××™';
  if (titleLower.includes('×ž×œ×’×–×Ÿ') || titleLower.includes('×ž×œ×’×–×”')) return '×ž×œ×’×–×Ÿ';
  if (titleLower.includes('×ž×œ×§×˜') || titleLower.includes('×œ×™×§×•×˜')) return '×ž×œ×§×˜';
  if (titleLower.includes('× ×”×’')) return '× ×”×’_×”×¤×¦×”';
  if (titleLower.includes('×¨×¤×¨× ×˜')) return '×¨×¤×¨× ×˜_×©×˜×—';
  
  // ×©×™×¨×•×ª
  if (titleLower.includes('×©×™×¨×•×ª ×œ×§×•×—×•×ª') || (titleLower.includes('× ×¦×™×’') && titleLower.includes('×©×™×¨×•×ª'))) return '× ×¦×™×’_×©×™×¨×•×ª';
  if (titleLower.includes('×ª×ž×™×›×” ×˜×›× ×™×ª') || (titleLower.includes('×ª×ž×™×›×”') && !titleLower.includes('×ª×•×ž×š'))) return '×ª×ž×™×›×”_×˜×›× ×™×ª';
  
  // × ×ž×œ
  if (titleLower.includes('×¡×•×•×¨') || titleLower.includes('×œ××©×™× ×’') || titleLower.includes('××ª×ª') || 
      titleLower.includes('×¤×™× ×¨') || titleLower.includes('×˜×œ×ž×Ÿ')) return '×¢×•×‘×“_× ×ž×œ';
  
  // ×¤×™× × ×¡×™×
  if (titleLower.includes('×—×©×‘×•× ×•×ª') || titleLower.includes('×—×©×‘')) return '×ž× ×”×œ_×—×©×‘×•× ×•×ª';
  
  // ××—×–×§×”
  if (titleLower.includes('×ª×—×–×•×§×”') || titleLower.includes('××—×–×§×”')) return '××™×©_×ª×—×–×•×§×”';
  
  // ×ž×–×•×Ÿ
  if (titleLower.includes('××•×¤×”') || titleLower.includes('×ž××¤×™×™×”') || titleLower.includes('×§×•×¤××™')) return '×¢×•×‘×“_×ž×–×•×Ÿ';
  
  // ×‘×¨×™×¨×ª ×ž×—×“×œ - ×ž×›×™×¨×•×ª ×›×œ×œ×™
  if (titleLower.includes('×ž×›×™×¨×•×ª')) return '× ×¦×™×’_×ž×›×™×¨×•×ª_×˜×œ×¤×•× ×™';
  if (titleLower.includes('× ×¦×™×’')) return '× ×¦×™×’_×©×™×¨×•×ª';
  
  return null;
}

/**
 * ×ž×™×–×•×’ ×ª×’×™×•×ª ×§×™×™×ž×•×ª ×¢× ×—×“×©×•×ª
 */
function mergeKeywords(existingKeywords, newKeywords) {
  let existing = [];
  
  // × ×™×ª×•×— ×ª×’×™×•×ª ×§×™×™×ž×•×ª
  if (typeof existingKeywords === 'string') {
    if (existingKeywords.startsWith('[')) {
      try {
        existing = JSON.parse(existingKeywords);
      } catch {
        existing = existingKeywords.split(',').map(k => k.trim());
      }
    } else {
      existing = existingKeywords.split(',').map(k => k.trim());
    }
  } else if (Array.isArray(existingKeywords)) {
    existing = existingKeywords;
  }
  
  // ×ž×™×–×•×’ ×œ×œ× ×›×¤×™×œ×•×™×•×ª
  const merged = [...new Set([...existing.filter(Boolean), ...newKeywords])];
  return JSON.stringify(merged);
}

/**
 * ×ª×’×™×•×ª × ×•×¡×¤×•×ª ×œ×¤×™ ×ž×™×§×•×
 */
function getLocationTags(location) {
  const loc = location?.toLowerCase() || '';
  const tags = [];
  
  // ××–×•×¨×™×
  if (loc.includes('×ª×œ ××‘×™×‘') || loc.includes('×ª"×') || loc.includes('×’×œ×™×œ×•×ª') || 
      loc.includes('×¨×ž×ª ×’×Ÿ') || loc.includes('×‘× ×™ ×‘×¨×§') || loc.includes('×’×‘×¢×ª×™×™×')) {
    tags.push('×ž×¨×›×–', '×’×•×© ×“×Ÿ', '××–×•×¨ ×ª×œ ××‘×™×‘');
  }
  if (loc.includes('×—×™×¤×”') || loc.includes('× ×©×¨') || loc.includes('×§×¨×™×•×ª')) {
    tags.push('×¦×¤×•×Ÿ', '××–×•×¨ ×—×™×¤×”');
  }
  if (loc.includes('×‘××¨ ×©×‘×¢') || loc.includes('××©×“×•×“') || loc.includes('×“×™×ž×•× ×”')) {
    tags.push('×“×¨×•×', '× ×’×‘');
  }
  if (loc.includes('×™×¨×•×©×œ×™×') || loc.includes('×‘×™×ª ×©×ž×©') || loc.includes('×ž×•×“×™×¢×™×Ÿ')) {
    tags.push('×™×¨×•×©×œ×™× ×•×”×¡×‘×™×‘×”', '×©×¤×œ×”');
  }
  if (loc.includes('×›×¤×¨ ×¡×‘×') || loc.includes('×¨×¢× × ×”') || loc.includes('×”×¨×¦×œ×™×”') || loc.includes('× ×ª× ×™×”')) {
    tags.push('×©×¨×•×Ÿ', '×ž×¨×›×–');
  }
  if (loc.includes('×¤×ª×— ×ª×§×•×•×”') || loc.includes('×¤"×ª')) {
    tags.push('×ž×¨×›×–', '×’×•×© ×“×Ÿ');
  }
  if (loc.includes('×—×•×œ×•×Ÿ') || loc.includes('×‘×ª ×™×') || loc.includes('×¨××©×•×Ÿ')) {
    tags.push('×ž×¨×›×–', '×“×¨×•× ×ª×œ ××‘×™×‘');
  }
  if (loc.includes('×œ×•×“') || loc.includes('×¨×ž×œ×”')) {
    tags.push('×ž×¨×›×–', '×©×¤×œ×”');
  }
  
  return tags;
}

async function main() {
  console.log('ðŸš€ ×ž×ª×—×™×œ ×©×“×¨×•×’ ×ª×’×™×•×ª ×—×›×ž×•×ª...\n');
  
  const positions = await prisma.position.findMany({
    where: { active: true },
    include: { employer: true }
  });
  
  console.log(`ðŸ“Š × ×ž×¦××• ${positions.length} ×ž×©×¨×•×ª ×¤×¢×™×œ×•×ª\n`);
  
  let updated = 0;
  let skipped = 0;
  
  for (const pos of positions) {
    const posType = getPositionType(pos.title, pos.employer.name);
    
    if (!posType) {
      console.log(`âš ï¸ ×œ× ×–×•×”×” ×¡×•×’: ${pos.title}`);
      skipped++;
      continue;
    }
    
    const baseTags = SMART_TAGS[posType] || [];
    const locationTags = getLocationTags(pos.location);
    const employerTag = pos.employer.name;
    
    // ×”×•×¡×¤×ª ×ž×•×ª×’×™×/×—×‘×¨×•×ª ×¨×œ×•×•× ×˜×™×•×ª
    const brandTags = [];
    if (pos.title.toLowerCase().includes('geely') || pos.employer.name.includes('UNION')) {
      brandTags.push('GEELY', "×’'×™×œ×™", '×™×•× ×™×•×Ÿ', 'UNION');
    }
    if (pos.title.toLowerCase().includes('zeekr')) {
      brandTags.push('ZEEKR', '×–×™×§×¨');
    }
    if (pos.title.toLowerCase().includes('×œ×§×¡×•×¡')) {
      brandTags.push('×œ×§×¡×•×¡', 'Lexus', '×™×•×§×¨×”');
    }
    if (pos.title.toLowerCase().includes('×˜×•×™×•×˜×”')) {
      brandTags.push('×˜×•×™×•×˜×”', 'Toyota');
    }
    if (pos.employer.name.includes('×ž×–×¨×—×™')) {
      brandTags.push('×ž×–×¨×—×™ ×˜×¤×—×•×ª', '×‘× ×§ ×ž×–×¨×—×™');
    }
    if (pos.employer.name.includes('YES')) {
      brandTags.push('YES', '×ª×§×©×•×¨×ª', '×˜×œ×•×•×™×–×™×”', '×¡×œ×§×•×');
    }
    if (pos.employer.name.includes('×¡×œ×¢')) {
      brandTags.push('×¡×œ×¢ ×œ×•×’×™×¡×˜×™×§×”', '×ž×¨×œ×•"×’');
    }
    if (pos.employer.name.includes('×œ×•×’×™×¡×˜×™×§×¨')) {
      brandTags.push('×œ×•×’×™×¡×˜×™×§×¨', '×ž×—×¡×Ÿ');
    }
    
    const allNewTags = [...baseTags, ...locationTags, employerTag, ...brandTags];
    const mergedKeywords = mergeKeywords(pos.keywords, allNewTags);
    
    await prisma.position.update({
      where: { id: pos.id },
      data: { keywords: mergedKeywords }
    });
    
    const tagCount = JSON.parse(mergedKeywords).length;
    console.log(`âœ… ${pos.employer.name} | ${pos.title} | ${tagCount} ×ª×’×™×•×ª`);
    updated++;
  }
  
  console.log(`\nðŸŽ‰ ×¡×™×•×!`);
  console.log(`âœ… ×¢×•×“×›× ×•: ${updated} ×ž×©×¨×•×ª`);
  console.log(`âš ï¸ ×“×•×œ×’×•: ${skipped} ×ž×©×¨×•×ª`);
}

main()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
